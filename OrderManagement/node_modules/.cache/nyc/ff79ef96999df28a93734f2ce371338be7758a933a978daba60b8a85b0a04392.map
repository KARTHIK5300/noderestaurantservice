{"version":3,"sources":["total-aggregate.js"],"names":["mongoose","require","order","logger","totalAmounts","req","res","console","log","body","date","aggregate","$match","Date","$project","totalAmount","$sum","$multiply","count","error","totalResult","Error","message","send","viewOrders","module","exports"],"mappings":"mLAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;AACA,IAAMC,KAAK,GAAGD,OAAO,CAAC,sBAAD,CAArB;AACA;AACA,IAAME,MAAM,GAAGF,OAAO,CAAC,mBAAD,CAAtB;;AAEA,SAAeG,YAAf,CAA4BC,GAA5B,EAAiCC,GAAjC;AACIC,UAAAA,OAAO,CAACC,GAAR,CAAYH,GAAG,CAACI,IAAJ,CAASC,IAArB,EADJ;AAE2BR,UAAAA,KAAK,CAACS,SAAN;AACvB;AACI;AACIC,YAAAA,MAAM,EAAE;AACN;AACAF,cAAAA,IAAI,EAAE,IAAIG,IAAJ,CAASR,GAAG,CAACI,IAAJ,CAASC,IAAlB,CAFA,EADZ,EADJ;;;AAOE;AACEI,YAAAA,QAAQ,EAAE;AACV;AACA;AACC;AACCC,cAAAA,WAAW,EAAE,EAACC,IAAI,EAAE,EAAEC,SAAS,EAAE,CAAC,QAAD,EAAW,WAAX,CAAb,EAAP,EAJL;AAKRC,cAAAA,KAAK,EAAE,EAAEF,IAAI,EAAE,CAAR,EALC,EADZ,EAPF,CADuB;;;;AAkBvB,oBAACG,KAAD,EAAQC,WAAR,EAAwB;AACtB,gBAAID,KAAJ,EAAW,MAAME,KAAK,CAACF,KAAK,CAACG,OAAP,CAAX;AACXf,YAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BY,WAA5B;AACAd,YAAAA,GAAG,CAACiB,IAAJ,CAAS,EAACH,WAAW,EAAXA,WAAD,EAAT;AACD,WAtBsB,CAF3B,SAEQI,UAFR;;AA0BEjB,UAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA4BgB,UAA5B,EA1BF;;;AA6BAC,MAAM,CAACC,OAAP,GAAiBtB,YAAjB","sourceRoot":"C:\\Users\\m1048223\\Documents\\repoNode301\\nodejs301RepoProject\\OrderManagement\\src\\app\\controllers","sourcesContent":["const mongoose = require('mongoose');\r\nconst order = require(\"../model/order-model\");\r\n// const filter = require(\"../controllers/query-helper\");\r\nconst logger = require(\"../config/winston\");\r\n\r\nasync function totalAmounts(req, res) {\r\n    console.log(req.body.date);\r\n  const viewOrders = await order.aggregate(\r\n    [\r\n        {\r\n            $match: {\r\n              //  _id: ObjectId(req.body._id)\r\n              date: new Date(req.body.date)\r\n            }\r\n        },\r\n      {\r\n        $project: {\r\n        //   date: 1,\r\n        //   item: 1,\r\n         // _id: ObjectId(req.query._id),\r\n          totalAmount: {$sum: { $multiply: [\"$price\", \"$quantity\"] }},\r\n          count: { $sum: 1 }\r\n        }\r\n      }\r\n    ],\r\n    (error, totalResult) => {\r\n      if (error) throw Error(error.message);\r\n      console.log(\"total amount\", totalResult);\r\n      res.send({totalResult});\r\n    }\r\n  );\r\n  console.log('view orders' , viewOrders);\r\n}\r\n\r\nmodule.exports = totalAmounts;\r\n"]}