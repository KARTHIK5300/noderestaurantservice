{"version":3,"sources":["total-amount.js"],"names":["mongoose","require","ObjectId","Types","order","logger","totalAmounts","req","res","aggregate","$match","_id","query","$project","totalAmount","$multiply","count","$sum","error","totalResult","Error","message","console","log","send","data","viewOrders","module","exports"],"mappings":"oLAAA;AACA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;AACA,IAAMC,QAAQ,GAAEF,QAAQ,CAACG,KAAT,CAAeD,QAA/B;AACA,IAAME,KAAK,GAAGH,OAAO,CAAC,sBAAD,CAArB;AACA;AACA,IAAMI,MAAM,GAAGJ,OAAO,CAAC,mBAAD,CAAtB;;AAEA,SAAeK,YAAf,CAA4BC,GAA5B,EAAiCC,GAAjC;AAC2BJ,UAAAA,KAAK,CAACK,SAAN;AACvB;AACI,YAACC,MAAM,EAAE;AACPC,cAAAA,GAAG,EAAET,QAAQ,CAACK,GAAG,CAACK,KAAJ,CAAUD,GAAX,CADN,EAAT,EADJ;;AAIE;AACEE,YAAAA,QAAQ,EAAE;AACV;AACA;AACC;AACCC,cAAAA,WAAW,EAAE,EAAEC,SAAS,EAAE,CAAC,QAAD,EAAW,WAAX,CAAb,EAJL;AAKRC,cAAAA,KAAK,EAAE,EAAEC,IAAI,EAAE,CAAR,EALC,EADZ,EAJF,CADuB;;;;AAevB,oBAACC,KAAD,EAAQC,WAAR,EAAwB;AACtB,gBAAID,KAAJ,EAAW,MAAME,KAAK,CAACF,KAAK,CAACG,OAAP,CAAX;AACXC,YAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BJ,WAA5B;AACAX,YAAAA,GAAG,CAACgB,IAAJ,CAAS,EAAEC,IAAI,EAAEN,WAAR,EAAT;AACD,WAnBsB,CAD3B,SACQO,UADR;;;;AAwBAC,MAAM,CAACC,OAAP,GAAiBtB,YAAjB","sourceRoot":"C:\\Users\\m1048223\\Documents\\repoNode301\\nodejs301RepoProject\\OrderManagement\\src\\app\\controllers","sourcesContent":["// import mongoose from \"mongoose\";\r\nconst mongoose = require('mongoose');\r\nconst ObjectId= mongoose.Types.ObjectId;\r\nconst order = require(\"../model/order-model\");\r\n// const filter = require(\"../controllers/query-helper\");\r\nconst logger = require(\"../config/winston\");\r\n\r\nasync function totalAmounts(req, res) {\r\n  const viewOrders = await order.aggregate(\r\n    [\r\n        {$match: {\r\n          _id: ObjectId(req.query._id)\r\n        }},\r\n      {\r\n        $project: {\r\n        //   date: 1,\r\n        //   item: 1,\r\n         // _id: ObjectId(req.query._id),\r\n          totalAmount: { $multiply: [\"$price\", \"$quantity\"] },\r\n          count: { $sum: 1 }\r\n        }\r\n      }\r\n    ],\r\n    (error, totalResult) => {\r\n      if (error) throw Error(error.message);\r\n      console.log(\"total amount\", totalResult);\r\n      res.send({ data: totalResult });\r\n    }\r\n  );\r\n}\r\n\r\nmodule.exports = totalAmounts;\r\n"]}